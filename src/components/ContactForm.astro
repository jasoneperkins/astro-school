---

interface Props {
  context?: string
  submitText?: string
  theme?: 'light' | 'dark'
  btnColor?: 'blue' | 'green' | 'orange' | 'red' | 'white'
}

const {
  context = 'General',
  submitText = 'Send Message',
  theme = 'light',
  btnColor = 'blue'
} = Astro.props

const labelClass = theme === 'light' ? 'text-gray-700' : 'text-white'
const buttonClass = `btn btn-${btnColor} w-full justify-center`
---

<div class="contact-container" x-data="contactHandler">
  <template x-if="state === 'success'">
    <div
      class="success-state animate-fade-in rounded-lg border-2 border-green-200 bg-green-50 p-6 text-center"
      role="alert">
      <h3 class="text-xl font-bold text-green-800">Message Sent!</h3>
      <p class="mt-2 text-green-700">
        Shalom! Your message has been sent to Miss Cindy. We'll be in touch
        soon.
      </p>
    </div>
  </template>

  <template x-if="state !== 'success'">
    <div class="form-wrapper">
      <form
        @submit.prevent="submitForm"
        class="contactForm grid grid-cols-1 gap-y-4"
        novalidate>
        <input type="hidden" name="sourceContext" value={context} />

        <div>
          <label
            for="parentName"
            class={`block text-sm font-medium ${labelClass}`}>
            Parent Name
          </label>
          <input
            type="text"
            id="parentName"
            name="parentName"
            required
            autocomplete="name"
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
          />
        </div>

        <div>
          <label for="email" class={`block text-sm font-medium ${labelClass}`}>
            Email Address
          </label>
          <input
            type="email"
            id="email"
            name="email"
            required
            autocomplete="email"
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
          />
        </div>

        <div class="col-span-full">
          <label
            for="message"
            class={`block text-sm font-medium ${labelClass}`}>
            Your Message
          </label>
          <textarea
            id="message"
            name="message"
            rows="4"
            required
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
          </textarea>
        </div>

        <button
          type="submit"
          :disabled="state === 'loading'"
          class={buttonClass}>
          <span x-show="state !== 'loading'">{submitText}</span>
          <span x-show="state === 'loading'" x-cloak>Sending...</span>
        </button>

        <p
          x-show="state === 'error'"
          class="mt-2 text-center text-sm text-red-600"
          role="alert"
          x-cloak>
          Something went wrong. Please try again or call the office.
        </p>
      </form>
    </div>
  </template>
</div>
