---
import {SEO} from 'astro-seo'
import {urlFor} from '@services/sanity'
import {ClientRouter} from 'astro:transitions'

import type {Info} from '@interfaces/info'
import type {Identity} from '@interfaces/identity'
import type {Seo} from '@interfaces/seo'

interface Props {
  info: Info
  identity: Identity
  seo: Seo
}

const {href} = Astro.url
const {info, identity, seo} = Astro.props

const {title, subTitle, slug, publishDate, images, author} = info
const {name: siteName, email, phone, address} = identity
const {metaTitle, metaDescription, shareImage, noIndex} = seo

const displayTitle = metaTitle || title || siteName
const titleTemplate = slug?.current === 'index' ? undefined : `%s | ${siteName}`

const ogImageUrl = images?.[0]
  ? urlFor(images[0]).width(1200).height(630).url()
  : '/default-og.jpg'
const isLive = false
---

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <SEO
    title={displayTitle}
    titleTemplate={titleTemplate}
    description={metaDescription}
    canonical={href}
    openGraph={{
      basic: {
        title: displayTitle,
        type: 'website',
        image: ogImageUrl
      },
      article: {
        authors: [author]
      }
    }}
    twitter={{
      card: 'summary_large_image',
      title: displayTitle,
      description: metaDescription,
      image: ogImageUrl
    }}
    noindex={!isLive}
    nofollow={!isLive}
  />

  <link rel="icon" href="/favicon.ico" sizes="any" />
  <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" />

  <link rel="manifest" href="site.webmanifest" />
  <meta name="theme-color" content="#fafafa" />
  <meta name="generator" content={Astro.generator} />
  <ClientRouter />
</head>
