---
import Layout from '@layouts/Common.astro'

import { PortableText } from 'astro-portabletext'
import { fetchClassroom, fetchClassrooms } from '@queries/classroom'

import type { Classroom } from '@interfaces/classroom'
import type { Seo } from '@interfaces/seo'
import type { Social } from '@interfaces/social'

interface Props {
  info: Classroom['info']
  content: Classroom['content']
  seo: Seo
  social: Social
}

export async function getStaticPaths() {
  const classrooms = await fetchClassrooms()

  return classrooms.map(({ info }) => ({
    params: { slug: info.slug.current },
    props: { slug: info.slug.current }
  }))
}

const { slug } = Astro.params
const { info, content, seo, social } = await fetchClassroom(slug)

export const prerender = true
---

<Layout info={info} seo={seo} social={social}>
  {
    content?.map((section) => (
      <section>
        <PortableText value={section.body} />
      </section>
    ))
  }
</Layout>
